–°–µ—Ä–≤—ñ—Å –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –æ–≥–æ–ª–æ—à–µ–Ω—å –Ω–∞ OLX –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏ –≤ Telegram.

## –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

- ‚úÖ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –æ–≥–æ–ª–æ—à–µ–Ω—å OLX —á–µ—Ä–µ–∑ GraphQL API
- üö´ –ù–∞–ª–∞—à—Ç–æ–≤—É–≤–∞–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–æ—à—É–∫—É (–∫–∞—Ç–µ–≥–æ—Ä—ñ—è, —Ü—ñ–Ω–∞, –º—ñ—Å—Ü–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤ Telegram –ø—Ä–æ:
    - –ù–æ–≤—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
    - –ó–º—ñ–Ω–∏ —Ü—ñ–Ω
    - –í–∏–¥–∞–ª–µ–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
- ‚úÖ –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Docker —Ç–∞ systemd

## –í–∏–º–æ–≥–∏

- PHP 8.4+
- MySQL 8.0+
- Composer
- Telegram Bot Token

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```bash
git clone <repository>
cd olx-monitor
composer install
cp .env.example .env
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è .env —Ñ–∞–π–ª—É

```bash
DATABASE_USER=olx_user
DATABASE_PASSWORD=olx_password
DATABASE_NAME=olx_monitor
DATABASE_HOST=mysql
TELEGRAM_BOT_TOKEN=
OLX_API_URL=https://www.olx.ua/apigateway/graphql
LOG_LEVEL=info
MONITOR_INTERVAL=3600
```

### 3. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
make setup
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞

```bash
make create-filter \
  NAME="–ö–≤–∞—Ä—Ç–∏—Ä–∏ –≤ —Ü–µ–Ω—Ç—Ä—ñ" \
  CATEGORY="–Ω–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å" \
  SUBCATEGORY="–∫–≤–∞—Ä—Ç–∏—Ä–∏" \
  TYPE="–¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–∞ –æ—Ä–µ–Ω–¥–∞" \
  PRICE="10000" OR "10000,15000" \
  REGION_ID="10" \
  CITY_ID="247" \
  APARTMENT_TYPE="–∂–∏—Ç–ª–æ–≤–∏–π —Ñ–æ–Ω–¥ 2001-2010" \
  AREA="50" OR "50,75" \
  DISTANCE="10" (e.g. km)
```

### –ó–∞–ø—É—Å–∫ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

#### –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π –∑–∞–ø—É—Å–∫
```bash
make monitor
```

#### Daemon —Ä–µ–∂–∏–º
```bash
make daemon
```

#### –ß–µ—Ä–µ–∑ systemd
```bash
make install-service
make status
make service-logs
```

#### –ß–µ—Ä–µ–∑ cron
```bash
make install-cron
```

### Docker

```bash
make docker-build
make docker-up
make docker-logs
```

## API –∫–æ–º–∞–Ω–¥–∏

### –ö–æ–Ω—Å–æ–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä
php bin/console filter:create --name="Test" --category="–Ω–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å" --subcategory="–∫–≤–∞—Ä—Ç–∏—Ä–∏" --type="–¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–∞ –æ—Ä–µ–Ω–¥–∞"

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏
php bin/console filter:list

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
php bin/console monitor:run

# –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ—ñ–ª—å—Ç—Ä–∞
php bin/console monitor:run --filter-id="uuid"
```

### –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ `http://localhost:8080` –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
src/
‚îú‚îÄ‚îÄ Entity/           # –°—É—Ç–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ Repository/       # –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ë–î
‚îú‚îÄ‚îÄ Service/          # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
‚îú‚îÄ‚îÄ Http/            # HTTP –∫–ª—ñ—î–Ω—Ç–∏
‚îú‚îÄ‚îÄ Console/         # –ö–æ–Ω—Å–æ–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏
‚îî‚îÄ‚îÄ DependencyInjection/ # DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

bin/
‚îú‚îÄ‚îÄ console          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–ª—è –∫–æ–º–∞–Ω–¥
‚îî‚îÄ‚îÄ monitor-daemon   # Daemon –¥–ª—è –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

public/
‚îî‚îÄ‚îÄ index.php        # –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å

migrations/          # SQL –º—ñ–≥—Ä–∞—Ü—ñ—ó
docker/             # Docker –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
systemd/            # Systemd —Å–µ—Ä–≤—ñ—Å–∏
cron/              # Cron –∑–∞–≤–¥–∞–Ω–Ω—è
```

## –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è OLX API

–°–µ—Ä–≤—ñ—Å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î GraphQL API OLX. –û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

### –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó (–ø—Ä–∏–∫–ª–∞–¥–∏)
- `–Ω–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å` ‚Üí `–∫–≤–∞—Ä—Ç–∏—Ä–∏` ‚Üí `–¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–∞ –æ—Ä–µ–Ω–¥–∞`
- `–Ω–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å` ‚Üí `–±—É–¥–∏–Ω–∫–∏` ‚Üí `–ø—Ä–æ–¥–∞–∂`
- `—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç` ‚Üí `–ª–µ–≥–∫–æ–≤—ñ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ`

### –§—ñ–ª—å—Ç—Ä–∏
- `price` - –¥—ñ–∞–ø–∞–∑–æ–Ω —Ü—ñ–Ω (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 10000 –∞–±–æ 10000,15000)
- `region-id` - ID —Ä–µ–≥—ñ–æ–Ω—É
- `city-id` - ID –º—ñ—Å—Ç–∞
- `apartment-type` - —Ç–∏–ø –∫–≤–∞—Ä—Ç–∏—Ä–∏
- `area` - –ø–ª–æ—â–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 10 –∞–±–æ 10,20)
- `distance` - –≤—ñ–¥—Å—Ç–∞–Ω—å —É –∫–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 10)

## –õ–æ–≥—É–≤–∞–Ω–Ω—è

–õ–æ–≥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤:
- `logs/app.log` - –æ—Å–Ω–æ–≤–Ω—ñ –ª–æ–≥–∏
- stdout - –¥–ª—è Docker
- systemd journal - –¥–ª—è systemd —Å–µ—Ä–≤—ñ—Å—É

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –∞–ª–µ—Ä—Ç–∏

### Telegram —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è

üÜï **–ù–æ–≤–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**
```
üÜï –ù–æ–≤–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è!

üìã 2-–∫—ñ–º–Ω–∞—Ç–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä—ñ
üí∞ 15000 UAH
üìç –ö–∏—ó–≤, –®–µ–≤—á–µ–Ω–∫—ñ–≤—Å—å–∫–∏–π —Ä–∞–π–æ–Ω
üîó https://olx.ua/...
```

üìà **–ó–º—ñ–Ω–∞ —Ü—ñ–Ω–∏**
```
üìà –ó–º—ñ–Ω–∞ —Ü—ñ–Ω–∏!

üìã 2-–∫—ñ–º–Ω–∞—Ç–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä—ñ
üí∞ –ë—É–ª–æ: 15000 UAH
üí∞ –°—Ç–∞–ª–æ: 14000 UAH
üìä –†—ñ–∑–Ω–∏—Ü—è: -1000 UAH
üîó https://olx.ua/...
```

‚ùå **–í–∏–¥–∞–ª–µ–Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**
```
‚ùå –û–≥–æ–ª–æ—à–µ–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–æ

üìã 2-–∫—ñ–º–Ω–∞—Ç–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä—ñ
üí∞ 15000 UAH
üìç –ö–∏—ó–≤, –®–µ–≤—á–µ–Ω–∫—ñ–≤—Å—å–∫–∏–π —Ä–∞–π–æ–Ω
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
make test
```

## –†–æ–∑—Ä–æ–±–∫–∞

### –ö–æ–¥—Å—Ç–∞–π–ª
```bash
make fix  # –í–∏–ø—Ä–∞–≤–∏—Ç–∏ —Å—Ç–∏–ª—å –∫–æ–¥—É
```

### –°—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑
```bash
./vendor/bin/phpstan analyse src --level=8
```
